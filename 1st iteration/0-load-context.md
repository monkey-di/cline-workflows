---
description: "Загрузка контекста проекта с адаптивной глубиной анализа"
---

# Загрузка контекста проекта (адаптивная версия)

## ОЦЕНКА СЛОЖНОСТИ ЗАДАЧИ

### Быстрая диагностика
**АНАЛИЗ задачи пользователя:**
- Масштаб: ОПРЕДЕЛЯЕТСЯ по ключевым словам и описанию
- Контекст: ОЦЕНИВАЕТСЯ по количеству потенциальных файлов
- Специфика: ВЫЯВЛЯЕТСЯ тип изменений

### Критерии пропуска этапа LOAD
Данный этап ПРОПУСКАЕТСЯ если:
- [ ] Пользователь указал конкретные файлы для работы (≤3 файла)
- [ ] Задача касается только одного компонента/модуля
- [ ] Контекст полностью определен в описании задачи
- [ ] Отсутствуют зависимости от документации проекта

**ЕСЛИ ВСЕ УСЛОВИЯ ВЫПОЛНЕНЫ: ПЕРЕХОД К СЛЕДУЮЩЕМУ ЭТАПУ**

---

## РЕЖИМЫ РАБОТЫ

### РЕЖИМ 1: БЫСТРЫЙ (для простых задач)
**Активируется если:**
- Задача ПРОСТАЯ или ТРИВИАЛЬНАЯ по сложности
- Контекст ограничен 1-3 файлами
- Нет архитектурных вопросов

**Действия:**
1. Прочитать только `.context/README.md` (если существует)
2. Найти и прочитать указанные в задаче файлы
3. ПЕРЕЙТИ к выполнению задачи

### РЕЖИМ 2: СТАНДАРТНЫЙ (для средних задач)
**Активируется если:**
- Задача СРЕДНЕЙ сложности
- Требуется понимание нескольких модулей
- Есть потенциальные зависимости

**Действия:**
1. Выполнить полный алгоритм загрузки контекста
2. Прочитать всю базовую документацию
3. Провести анализ релевантных файлов

### РЕЖИМ 3: ГЛУБОКИЙ (для сложных задач)
**Активируется если:**
- Задача СЛОЖНАЯ
- Требуется архитектурное понимание
- Множественные зависимости и интеграции

**Действия:**
1. Полная загрузка контекста
2. Дополнительный анализ архитектуры
3. Исследование паттернов и соглашений

---

## АЛГОРИТМ РАБОТЫ

### Шаг 0: Определение режима
```
РЕЖИМ = определить_режим_по_сложности(задача_пользователя)
КОНТЕКСТ_ФАЙЛЫ = определить_необходимые_файлы(задача_пользователя, РЕЖИМ)
```

### Шаг 1: Базовая загрузка (все режимы)
Прочитать следующие файлы, если они существуют:

**Обязательные:**
- `.context/README.md` - общий контекст проекта

**Условные (по сложности):**
- `.context/PRD.md` - бизнес-требования (СТАНДАРТНЫЙ, ГЛУБОКИЙ)
- `.context/tips/INDEX.md` - повторно используемые примеры (СТАНДАРТНЫЙ, ГЛУБОКИЙ)
- `.context/docs/INDEX.md` - структура документации (ГЛУБОКИЙ)

### Шаг 2: Получение задачи
1. **Получить задачу от пользователя**
   - Если задача не предоставлена, ОБЯЗАТЕЛЬНО запросить её
   - Проанализировать сложность и область воздействия

### Шаг 3: Релевантный контекст (адаптивно)

#### БЫСТРЫЙ режим:
- Прочитать только файлы, упомянутые в задаче
- Пропустить анализ документации

#### СТАНДАРТНЫЙ режим:
```
НА ОСНОВЕ `.context/tips/INDEX.md` и `.context/docs/INDEX.md`:
1. Определить релевантные файлы для задачи
2. Прочитать ТОЛЬКО применимые к задаче файлы
3. Пропустить общую документацию, не связанную с задачей
```

#### ГЛУБОКИЙ режим:
```
ДОПОЛНИТЕЛЬНО к стандартному:
1. Прочитать архитектурную документацию
2. Изучить соглашения и паттерны проекта
3. Проанализировать интеграционные точки
```

### Шаг 4: Валидация контекста
**Проверить достаточность контекста:**
- [ ] Понятен ли технологический стек?
- [ ] Ясны ли архитектурные принципы?
- [ ] Доступны ли примеры похожих реализаций?
- [ ] Известны ли ограничения и соглашения?

**ЕСЛИ контекст недостаточен:** дочитать недостающие файлы

---

## ОПТИМИЗАЦИИ ПРОИЗВОДИТЕЛЬНОСТИ

### Интеллектуальная фильтрация файлов
```
ФУНКЦИЯ определить_релевантные_файлы(задача, индексы_документации):
    ключевые_слова = извлечь_ключевые_слова(задача)
    
    релевантные = []
    ДЛЯ КАЖДОГО файла В индексы_документации:
        релевантность = вычислить_релевантность(файл, ключевые_слова)
        ЕСЛИ релевантность > ПОРОГ:
            добавить_в_список(релевантные, файл)
    
    ВОЗВРАТ отсортировать_по_приоритету(релевантные)
```

### Порядок чтения по приоритету
1. **Критический контекст** - файлы, напрямую связанные с задачей
2. **Архитектурный контекст** - понимание структуры и принципов
3. **Примеры и паттерны** - аналогичные реализации
4. **Вспомогательная документация** - общие сведения

### Механизм остановки чтения
```
ПОСЛЕ каждого файла проверять:
ЕСЛИ (прочитанных_файлов > 5) И (контекст_достаточен):
    ОСТАНОВИТЬ чтение дополнительной документации
```

---

## ПЕРЕДАЧА КОНТЕКСТА

### Структурированная передача
**Формат передачи контекста следующему этапу:**

```markdown
## ЗАГРУЖЕННЫЙ КОНТЕКСТ

### Метаданные
- Режим загрузки: [БЫСТРЫЙ|СТАНДАРТНЫЙ|ГЛУБОКИЙ]
- Количество прочитанных файлов: X
- Время загрузки: X секунд

### Проектный контекст
- Технологический стек: [список]
- Архитектурные принципы: [краткое описание]
- Ключевые соглашения: [список]

### Релевантный контекст для задачи
- Связанные компоненты: [список]
- Примеры аналогичных решений: [ссылки на файлы]
- Потенциальные зависимости: [список]

### Рекомендации для следующих этапов
- Предлагаемый уровень детализации: [МИНИМАЛЬНЫЙ|СТАНДАРТНЫЙ|ДЕТАЛЬНЫЙ]
- Критические области для исследования: [список]
- Потенциальные риски: [список]
```

---

## САМОДОСТАТОЧНОСТЬ ПРОМПТА

### Минимальный контекст для автономной работы
Для работы без предыдущих этапов достаточно:
- Описание задачи от пользователя
- Доступ к файловой системе проекта
- Один из файлов: `.context/README.md` ИЛИ основной файл проекта

### Алгоритм экстренной загрузки контекста
```
ЕСЛИ отсутствует базовая документация:
1. Найти главный файл проекта (package.json, requirements.txt, и т.д.)
2. Определить технологический стек по файлам проекта
3. Найти основные директории (src/, app/, components/)
4. Провести быстрый анализ структуры проекта
```

### Критерии завершения загрузки
- ✅ Определен технологический стек проекта
- ✅ Понятна структура проекта
- ✅ Найдены файлы, связанные с задачей
- ✅ Собраны примеры аналогичных решений (если есть)
- ✅ Выявлены потенциальные зависимости и ограничения

---

## МЕТРИКИ ЭФФЕКТИВНОСТИ

### Измеряемые показатели
- **Время загрузки контекста**: целевое время ≤ 60 секунд
- **Релевантность загруженного контекста**: % полезной информации ≥ 80%
- **Полнота контекста**: % задач, не требующих дозагрузки контекста ≥ 90%

### Критерии качества
- **Достаточность**: следующий этап может работать автономно
- **Эффективность**: минимум избыточной информации
- **Точность**: весь контекст релевантен задаче

---

## ОБРАТНАЯ СВЯЗЬ И АДАПТАЦИЯ

### Автоматическое улучшение
После завершения задачи анализировать:
- Был ли загруженный контекст достаточным?
- Какие файлы оказались наиболее полезными?
- Потребовалась ли дозагрузка контекста?

### Обновление алгоритмов
На основе накопленных данных корректировать:
- Веса релевантности для разных типов файлов
- Пороги для переключения между режимами
- Приоритеты чтения документации

---

## ЗАВЕРШЕНИЕ ЭТАПА

**Финальная проверка:**
- Задача получена и понята
- Контекст загружен в соответствии со сложностью
- Следующий этап может работать автономно
- Переданы рекомендации для оптимизации дальнейшей работы

**ПЕРЕХОД к следующему этапу с полным контекстом**