---
description: "Адаптивная инициализация контекста проекта с механизмами пропуска"
---

# Инициализация контекста проекта (адаптивная версия)

## ОЦЕНКА НЕОБХОДИМОСТИ ЭТАПА

### Критерии пропуска этапа INIT
Данный этап ПРОПУСКАЕТСЯ если:
- [ ] Файл `.context/README.md` уже существует и актуален
- [ ] Проект ранее анализировался (в течение последних 30 дней)
- [ ] Задача касается только локальных изменений (1-2 файла)
- [ ] Пользователь предоставил полный контекст проекта

**ЕСЛИ ВСЕ УСЛОВИЯ ВЫПОЛНЕНЫ: ПЕРЕХОД К LOAD-CONTEXT ИЛИ СЛЕДУЮЩЕМУ ЭТАПУ**

### Быстрая проверка актуальности
```
ЕСЛИ файл `.context/README.md` существует:
    ПРОВЕРИТЬ дату последнего обновления
    ЕСЛИ обновлялся < 30 дней назад И размер проекта не изменился значительно:
        ОПЦИОНАЛЬНО: предложить обновить только изменившиеся разделы
        ИНАЧЕ: выполнить полную инициализацию
```

---

## РЕЖИМЫ ИНИЦИАЛИЗАЦИИ

### РЕЖИМ 1: ЭКСПРЕСС (для малых проектов)
**Активируется если:**
- Проект содержит < 50 файлов исходного кода
- Используется 1-2 основные технологии
- Архитектура простая (монолитная или простая модульная)

**Время выполнения:** 2-5 минут

### РЕЖИМ 2: СТАНДАРТНЫЙ (для средних проектов)
**Активируется если:**
- Проект содержит 50-200 файлов исходного кода
- Используется 3-5 технологий
- Архитектура умеренной сложности

**Время выполнения:** 5-15 минут

### РЕЖИМ 3: ГЛУБОКИЙ (для крупных проектов)
**Активируется если:**
- Проект содержит > 200 файлов исходного кода
- Сложный технологический стек
- Микросервисная или сложная модульная архитектура

**Время выполнения:** 15-30 минут

---

## АДАПТИВНЫЙ АЛГОРИТМ АНАЛИЗА

### Шаг 1: Быстрая оценка проекта
```
1. Подсчитать количество файлов исходного кода
2. Определить основные технологии по файлам конфигурации
3. Оценить структурную сложность
4. Выбрать режим инициализации
```

### Шаг 2: Приоритизированный анализ

#### ЭКСПРЕСС режим:
1. **Корневая директория** (обязательно)
   - Файлы конфигурации (package.json, requirements.txt, и т.д.)
   - README файлы
   - Основные директории (src/, app/, lib/)

2. **Ключевые файлы** (по 1-2 из каждой категории)
   - Главные компоненты/модули
   - Основные конфигурации
   - Примеры использования

#### СТАНДАРТНЫЙ режим:
1. Все из ЭКСПРЕСС режима
2. **Архитектурный анализ**
   - Структура модулей
   - Паттерны именования
   - Зависимости между компонентами

3. **Технологический стек**
   - Полный список используемых технологий
   - Версии и конфигурации
   - Инструменты сборки и развертывания

#### ГЛУБОКИЙ режим:
1. Все из предыдущих режимов
2. **Детальный анализ архитектуры**
   - Паттерны проектирования
   - Интеграции и зависимости
   - Соглашения и стандарты кодирования

3. **Анализ производительности и масштабирования**

### Шаг 3: Интеллектуальное сканирование
```
АЛГОРИТМ интеллектуального_сканирования:
    приоритетные_директории = ["src", "app", "components", "pages", "api", "backend"]
    
    ДЛЯ КАЖДОЙ директории В приоритетные_директории:
        ЕСЛИ директория существует:
            проанализировать_структуру(директория)
            найти_ключевые_файлы(директория)
            определить_паттерны(директория)
        
        ЕСЛИ время_анализа > лимит_времени_для_режима:
            ЗАВЕРШИТЬ с предупреждением о неполном анализе
```

---

## СИСТЕМА ПЕРЕИСПОЛЬЗОВАНИЯ

### Поиск существующих решений
```
ФУНКЦИЯ найти_аналогичные_проекты():
    типы_проектов = ["React SPA", "Node.js API", "Vue.js приложение", "Express backend"]
    
    ДЛЯ КАЖДОГО типа В типы_проектов:
        ЕСЛИ проект_соответствует_типу(тип):
            загрузить_шаблон_контекста(тип)
            адаптировать_под_текущий_проект()
            ВОЗВРАТ адаптированный_шаблон
```

### Базовые шаблоны проектов

#### Frontend проекты:
- React/Next.js приложения
- Vue.js/Nuxt.js приложения  
- Angular приложения
- Статические сайты

#### Backend проекты:
- Node.js/Express API
- Python/Django приложения
- PHP/Laravel приложения
- Микросервисы

#### Full-stack проекты:
- MERN стек
- MEAN стек
- Django + React
- Laravel + Vue

---

## ОПТИМИЗИРОВАННОЕ ЗАПОЛНЕНИЕ КОНТЕКСТА

### Шаблон `.context/README.md`
```markdown
# Проект: [AUTO_DETECT_NAME]

## ОБЗОР СИСТЕМЫ
### Назначение
[AUTO_GENERATED на основе анализа]

### Основной функционал  
[AUTO_GENERATED список ключевых возможностей]

### Архитектура
- Тип: [Монолитное|Модульное|Микросервисы|SPA|и т.д.]
- Паттерны: [выявленные паттерны проектирования]

## ТЕХНОЛОГИЧЕСКИЙ СТЕК

### Frontend (если применимо)
[AUTO_DETECTED технологии и версии]

### Backend (если применимо)  
[AUTO_DETECTED технологии и версии]

### База данных
[AUTO_DETECTED тип и конфигурация]

### Инструменты разработки
[AUTO_DETECTED инструменты сборки, тестирования, развертывания]

## СТРУКТУРА ПРОЕКТА
[AUTO_GENERATED дерево основных директорий с описаниями]

## КЛЮЧЕВЫЕ СОГЛАШЕНИЯ
[AUTO_DETECTED соглашения именования, структуры, стилей]

## ТОЧКИ ИНТЕГРАЦИИ
[AUTO_DETECTED внешние сервисы, API, зависимости]

## СТАТИСТИКА АНАЛИЗА
- Режим инициализации: [ЭКСПРЕСС|СТАНДАРТНЫЙ|ГЛУБОКИЙ]
- Время анализа: X минут
- Проанализировано файлов: X из Y
- Достоверность анализа: [ВЫСОКАЯ|СРЕДНЯЯ|БАЗОВАЯ]
```

---

## ВАЛИДАЦИЯ И КАЧЕСТВО

### Автоматическая валидация контекста
```
ФУНКЦИЯ валидировать_контекст():
    критерии = [
        проверить_технологический_стек(),
        проверить_структуру_проекта(),
        проверить_ключевые_файлы(),
        проверить_зависимости()
    ]
    
    достоверность = вычислить_процент_достоверности(критерии)
    
    ЕСЛИ достоверность < 70%:
        предложить_ручное_дополнение()
    
    ВОЗВРАТ достоверность, рекомендации
```

### Критерии качества анализа
- **ВЫСОКАЯ достоверность (90-100%)**: Все ключевые аспекты определены автоматически
- **СРЕДНЯЯ достоверность (70-89%)**: Основные аспекты определены, требуются уточнения
- **БАЗОВАЯ достоверность (50-69%)**: Минимальный контекст, требуется дополнительный анализ

---

## САМОДОСТАТОЧНОСТЬ ПРОМПТА

### Минимальные требования для работы
- Доступ к файловой системе проекта
- Возможность создания файла `.context/README.md`
- Базовые алгоритмы анализа кода (встроены в промпт)

### Алгоритм экстренной инициализации
```
ЕСЛИ нет доступа к стандартным инструментам анализа:
1. Найти главный файл проекта по расширениям (.js, .py, .php, и т.д.)
2. Определить тип проекта по структуре директорий
3. Использовать базовые эвристики для определения технологий
4. Создать минимальный контекст с пометкой о необходимости доработки
```

---

## ИНТЕГРАЦИЯ С ПОСЛЕДУЮЩИМИ ЭТАПАМИ

### Передача оптимизированного контекста
```markdown
## РЕКОМЕНДАЦИИ ДЛЯ СЛЕДУЮЩИХ ЭТАПОВ

### Для LOAD-CONTEXT:
- Режим: [БЫСТРЫЙ|СТАНДАРТНЫЙ|ГЛУБОКИЙ]
- Приоритетные файлы: [список]
- Можно пропустить: [список нерелевантных файлов]

### Для DEFINE-TASK:
- Ожидаемая сложность задач: [ПРОСТЫЕ|СРЕДНИЕ|СЛОЖНЫЕ]
- Критические области: [список областей, требующих особого внимания]

### Для RESEARCH:
- Готовые паттерны: [список найденных паттернов]
- Области для исследования: [список]

### Для PLANNING:
- Архитектурные ограничения: [список]
- Рекомендуемые подходы: [список]
```

---

## МЕТРИКИ И ОБРАТНАЯ СВЯЗЬ

### Измеряемые показатели
- **Время инициализации**: по режимам
- **Точность определения технологий**: % правильно определенных
- **Полнота анализа**: % покрытия проекта
- **Качество рекомендаций**: полезность для следующих этапов

### Непрерывное улучшение
- Сбор обратной связи о точности анализа
- Обновление алгоритмов распознавания
- Оптимизация шаблонов для разных типов проектов

---

## ЗАВЕРШЕНИЕ ЭТАПА

### Критерии успешного завершения
- ✅ Файл `.context/README.md` создан и заполнен
- ✅ Определены основные технологии и архитектура
- ✅ Выявлены ключевые соглашения и паттерны
- ✅ Подготовлены рекомендации для следующих этапов
- ✅ Достоверность анализа ≥ 70%

### Финальная отчетность
```
ОТЧЕТ о завершении инициализации:
- Режим: [выбранный режим]
- Время выполнения: X минут
- Достоверность: X%
- Статус: [ЗАВЕРШЕНО|ЧАСТИЧНО|ТРЕБУЕТ_ДОРАБОТКИ]
- Следующий этап: [рекомендация]
```

**ПЕРЕХОД к следующему этапу с инициализированным контекстом**