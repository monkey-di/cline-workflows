---
description: "Analyse task and research"
---

## Контекст работы

Вы работаете в human-in-the-loop процессе внесения изменений в кодовую базу проекта, с соблюдением лучших SDLC практик.
Вы находитесь на этапе технического анализа и исследования задачи.

## Ваша цель

Собрать контекст, необходимый для начала проектирования.

Создать и заполнить проектный документ, основанный на последовательном анализе задачи и кодовой базы проекта.

ВАЖНО: на текущем этапе вы должны максимально точно и полно описать технический контекст, необходимый для максимально полного и точного понимания задачи, а не план её выполнения. Вы должны выполнять шаги процесса в строгой последовательности.

## Процесс

### 0. Понять контекст задачи

Внимательно прочтите и проанализируйте текущую задачу пользователя.

Входные данные:
- файл `task_definition.md` или описание задачи на естественном языке.
- Если входные данные отсутствуют, немедленно остановитесь и задайте пользователю вопрос через `ask_followup_question`

### 1. Понять контекст проекта

Прочтите следующие файлы, если они существуют:
- `.context/README.md`
- `.context/PRD.md`
- `.context/docs/INDEX.md`

### 2. Заполнить проектный документ

1. **Создайте шаблон исследования** `.context/tasks/{date-and-time}/{task_name}/research.md`

Создайте шаблон файла исследования, используя **универсальную структуру** (УЛУЧШЕНО - убраны избыточные специализации):

```markdown
# Техническое исследование: [Название задачи]

## 1. Обзор задачи
[Краткое описание требований]

## 2. Анализ существующей архитектуры  
[Релевантные части текущей системы]

## 3. Поиск аналогичных решений
[Найденные компоненты и паттерны для переиспользования]

## 4. Технические зависимости
[Модули, библиотеки, API которые потребуются]

## 5. Влияние на существующий код
[Файлы для изменения и их зависимости]

## 6. Рекомендуемый подход
[Техническое решение на основе найденных аналогов]
```

Вы должны вносить ЛЮБЫЕ дальнейшие изменения исключительно в этот файл. Изменять любые другие файлы недопустимо.

2. **Систематическое исследование кодовой базы (ДОБАВЛЕНО УЛУЧШЕНИЕ)**

**АЛГОРИТМ ПОИСКА АНАЛОГОВ:**

**Фаза 1 - Поиск точных аналогов (ПРИОРИТЕТ 1):**
```
1. Извлечь ключевые слова из задачи
2. Искать файлы с похожими именами (`search_files`)
3. Искать компоненты с похожей функциональностью (`list_code_definition_names`)
4. КРИТЕРИЙ ДОСТАТОЧНОСТИ: найдено 2+ точных аналога
```

**Фаза 2 - Поиск функциональных аналогов (ПРИОРИТЕТ 2):**
```
1. Анализировать логику похожих компонентов
2. Искать общие паттерны реализации
3. Определять архитектурные принципы проекта
4. КРИТЕРИЙ ДОСТАТОЧНОСТИ: найдено 3+ частичных аналога
```

**Фаза 3 - Анализ зависимостей (ПРИОРИТЕТ 3):**
```
1. Найти все места использования изменяемых компонентов
2. Проанализировать цепочки зависимостей
3. Определить критические интеграции
4. КРИТЕРИЙ ДОСТАТОЧНОСТИ: найдены все прямые зависимости
```

**МЕХАНИЗМ ОСТАНОВКИ**: Остановить исследование если:
- Потрачено >20 минут без нахождения новых аналогов
- Найдено >5 качественных аналогов  
- Проанализировано >50 файлов

3. **Последовательно заполните файл только достоверной информацией**

Код - единственный источник истины. **Никогда** не предполагай. Основывай свои ответы на **фактах** и **обратной связи** от пользователя.

### 3. Дополнить проектный документ существующими практиками

Прочтите документ:
- `.context/tips/INDEX.md`

Если вы найдёте в нём какие-либо практики и подходы, применимые к текущей задаче, внесите их в проектный документ.

### 4. Систематизация найденных решений (ДОБАВЛЕНО)

**Категоризация аналогов по применимости:**
- **Прямое переиспользование**: можно использовать без изменений
- **Адаптация**: требует небольших модификаций  
- **Базовая структура**: можно использовать как основу
- **Справочная информация**: полезно для понимания паттернов

**Для каждого аналога указать:**
- Путь к файлу: [`ComponentName.jsx`](src/components/ComponentName.jsx)
- Степень применимости: 90% / 70% / 40%
- Необходимые адаптации: список изменений

### 5. Обратная связь с человеком
- После завершения исследования предоставьте только очень краткое резюме (в пределах 1–2 предложений).
- Попросите человека просмотреть проект и подтвердить, соответствует ли он его ожиданиям, используя `ask_followup_question`

## Важные правила

**КРИТИЧЕСКИ ВАЖНО**: Исследуйте дерево зависимостей полностью. При работе с файлами кода понимание их зависимостей КРИТИЧЕСКИ ВАЖНО для:
1. Правильного изменения файла (чтобы сохранить совместимость с зависимым кодом)
2. Генерации точных модульных тестов (чтобы правильно имитировать зависимости)
3. Понимания полного контекста функциональности кода

При составлении документа убедитесь, что у вас есть ПОЛНЫЙ контекст. Это ваша ответственность.

**ПРИНЦИПЫ КАЧЕСТВЕННОГО ИССЛЕДОВАНИЯ:**
- Никаких догадок. Любое предположение — через вопрос пользователю или проверку кодовой базы.
- Вы ДОЛЖНЫ включать обратную связь пользователя в проектный документ
- Используйте диаграммы Mermaid, когда это уместно
- Избегайте излишних пояснений. Проектный документ должен быть кратким и не должен превышать 800 строк
- Описывайте **существующие решения и архитектуру**, а не план реализации задачи.

**ФИНАЛЬНОЕ ПРАВИЛО**: Ты проводишь исследование, а не пишешь код. НЕ ПРИСТУПАТЬ К ВЫПОЛНЕНИЮ САМОЙ ЗАДАЧИ. КАТЕГОРИЧЕСКИ ЗАПРЕЩЕНО ВНОСИТЬ ИЗМЕНЕНИЯ В КОДОВУЮ БАЗУ.