---
description: "Рефакторинг и улучшение существующего кода"
---

# Цель

Улучшить качество, читаемость и структуру существующего кода без изменения его внешнего поведения и функциональности.

## Входные данные
- Описание области для рефакторинга от пользователя
- Конкретные файлы или компоненты для улучшения
- Проблемы в коде, которые нужно исправить

## Принципы качественного рефакторинга

### КРИТИЧНЫЙ ПРИОРИТЕТ - Переиспользование паттернов:
- **Следуй существующим стандартам**: изучи, как организован аналогичный качественный код в проекте
- **Используй установленные утилиты**: не создавай новые хелперы, если есть существующие
- **Копируй успешные структуры**: найди хорошо организованные компоненты и воспроизведи их структуру

### ВЫСОКИЙ ПРИОРИТЕТ - Безопасность изменений:
- **Сохраняй интерфейсы**: публичные методы и их сигнатуры должны остаться неизменными
- **Не меняй поведение**: функциональность должна работать точно так же
- **Минимальные изменения**: делай маленькие безопасные шаги

## Процесс

### 1. Анализ области рефакторинга
1. **Изучение текущего кода**: Прочитай указанные файлы, пойми логику и структуру
2. **Поиск лучших практик в проекте**: Найди аналогичный код, который хорошо организован
3. **Анализ зависимостей**: Найди все места использования рефакторируемого кода

### 2. Поиск образцов для подражания
**АЛГОРИТМ ПОИСКА КАЧЕСТВЕННЫХ РЕШЕНИЙ:**
```
1. Найти компоненты с похожей функциональностью, но лучшей организацией
2. Проанализировать их структуру, именование, разделение ответственности
3. Определить применимые паттерны для текущего рефакторинга
РЕЗУЛЬТАТ: шаблон качественной организации кода
```

### 3. Планирование улучшений
**Приоритизация изменений:**
1. **Безопасные улучшения**: переименование, форматирование, комментарии
2. **Структурные улучшения**: извлечение функций, удаление дублирования
3. **Архитектурные улучшения**: улучшение разделения ответственности

### 4. Поэтапное выполнение
**Этап 1 - Безопасные изменения:**
- Переименование переменных и функций в соответствии с соглашениями проекта
- Форматирование кода в стиле проекта
- Добавление комментариев в принятом стиле

**Этап 2 - Извлечение повторяющегося кода:**
- Найти дублирование и вынести в отдельные функции
- Использовать существующие утилиты проекта
- Создать переиспользуемые компоненты по образцу существующих

**Этап 3 - Улучшение структуры:**
- Разбить длинные функции, следуя примерам в проекте
- Улучшить читаемость условий и циклов
- Применить паттерны, используемые в проекте

### 5. Валидация рефакторинга
- ✅ Поведение кода не изменилось
- ✅ Сохранены все публичные интерфейсы
- ✅ Улучшилась читаемость и структура
- ✅ Устранено дублирование
- ✅ Код соответствует стандартам проекта

## Типичные виды рефакторинга

### Извлечение функций (используй паттерны проекта):
```javascript
// Найди в проекте примеры разделения логики, воспроизведи структуру
// Используй установленные в проекте соглашения именования
```

### Упрощение условий (следуй стилю проекта):
```javascript
// Изучи, как в проекте организованы сложные условия
// Примени найденные паттерны к текущему коду
```

### Удаление дублирования (переиспользуй утилиты):
```javascript
// Найди существующие утилиты для общих операций
// Используй их вместо создания новых
```

## Области фокуса

### Frontend компоненты:
- Следуй структуре существующих компонентов
- Используй установленные хуки и utilities
- Применяй принятые паттерны управления состоянием

### Backend логика:
- Используй существующие сервисные слои
- Следуй паттернам валидации и обработки ошибок
- Применяй установленные принципы работы с БД

### Утилиты и хелперы:
- Группируй по образцу существующих модулей
- Используй принятые соглашения экспорта/импорта
- Следуй стандартам документации в проекте

## Результат
Улучшенный код, который легче читать и поддерживать, работает точно так же, как раньше, и соответствует стандартам проекта.